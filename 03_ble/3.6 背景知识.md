# 3.6背景知识



| 简写 | 术语                      | 说明                                            |
| ---- | ------------------------- | ----------------------------------------------- |
| ATT  | Attribute Protocol        | 属性协议                                        |
| GATT | Generic Attribute Profile | 通用属性配置文件，描述了一种使用ATT的服务框架。 |
|      | Advertising Bearer        | 广播承载层                                      |
|      | GATT Bearer               | GATT承载层                                      |



**mesh网络的动机**

典型应用场景包括楼宇自动化和传感器网络等。

- 覆盖面积广
- 直联互通性
- 监测和控制大量设备的能力
- 优化的，低功耗的
- 有效利用无线电资源，可扩展
- 与当前市场上的智能手机、平板电脑和个人电脑产品兼容
- 符合行业标准，具有政府级安全性





通过蓝牙mesh，能够将数据中继到不在初始设备直接覆盖范围内的其他设备。mesh网络能够跨越非常大的物理区域，并包含大量设备。



Provision启动配置，是向蓝牙mesh网络添加新的未经启动配置设备的过程。由启动配置设备Provisioner进行管理。

启动配置承载层（Provision Bearer）

PB-ADV，通过蓝牙广播信道进行设备启动配置的启动配置承载层。

PB-GATT，用来自代理协议的蓝牙mesh代理（proxy）PDU进行设备启动配置的启动配置承载层。



mesh网络设备默认使用的是广播承载层，负责在低功耗蓝牙广播数据包内收发蓝牙mesh的数据包。



既不支持也无法升级使用广播承载层的设备，必须使用GATT承载层。

使用GATT承载层时需要将蓝牙mesh协议数据单元（PDU）封装在代理协议（Proxy Protocol）中。



![img](http://www.rfsister.com/upfile/article/common/images/201712/19/ewjvnsp20r.jpg)





**代理节点**

代理节点是非mesh低功耗蓝牙设备成为蓝牙mesh网络成员的过程中的关键。

代理节点的根本目的是执行承载层转换，能够实现从广播承载层到GATT承载层的转换。不支持广播承载层的设备可以通过GATT连接来收发各类蓝牙Mesh消息。



**代理节点的发现**

低功耗蓝牙设备使用GAP广播来帮助其他设备发现自己。蓝牙mesh代理节点使用完全相同的技术，通过GAP可连接型广播（connectable advertising）数据包，对自身的可用性、可作为代理节点的角色、及身份进行广播。



节点标识广播的主要用途是将启动配置设备（Provisioner）快速链接到刚刚完成启动配置的节点，从而完成新节点的配置。



**启动配置provision**

启动配置是向蓝牙mesh网络添加新的未经启动配置设备的过程。该过程由启动配置设备（Provisioner）进行管理。启动配置设备和未经启动配置设备遵循蓝牙mesh规格中定义的固定过程。

启动配置设备向未经启动配置设备提供使其成为蓝牙mesh节点的启动配置数据（Provisioning data）。

![img](http://www.rfsister.com/upfile/article/common/images/201712/19/ewjx4mpbql.jpg)

启动配置协议栈如图，分为以下几个组件：

- 启动配置协议
- 启动配置传输
- 启动配置承载层（Provisioning Bearer），实现了启动配置PDU在启动配置设备和未经启动配置设备之间的传输。定义了两个启动配置承载层，包括B-ADV和B-GATT。
  - B-ADV，
  - B-GATT，





**蓝牙mesh网络安全性**

在低功耗蓝牙GATT的安全性配置是非强制性的。而在蓝牙mesh网络中的安全性涉及的不仅是单一设备或对等设备之间的连接安全性，还关注整个设备网络的安全性，以及网络中各组设备的安全性。

故而，在蓝牙mesh网络中，强制使用安全性。

| 安全策略         | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| 加密与认证       | 所有mesh消息都经过加密和认证。                               |
| 安全分级考量     | 网络安全性、应用安全性和设备安全性彼此独立。                 |
| 区域隔离         | 蓝牙mesh网络可分为若干子网，每个子网秘钥不同，独立于其他子网，各自都是安全的。 |
| 密钥刷新         | 通过密钥刷新过程，可以在蓝牙mesh网络的整个生命周期内更改安全密钥。 |
| 消息模糊化       | 消息模糊化的作用是让外界难以跟踪网络内所有发送的消息，进而提供一种隐私保护机制，难以让外界跟踪节点的网络活动。 |
| 中继共计防护     | 蓝牙mesh安全性可保护网络免收中继攻击。                       |
| 垃圾桶攻击防护   | 节点可从网络中安全地移除，可以防止垃圾桶攻击（Trash Can Attack）。 |
| 安全设备启动配置 | 设备添加到蓝牙mesh网络以成为节点的过程是一个安全的过程。     |



节点必须拥有网络密钥，才能成为网络中的成员。网络加密密钥（Encryption Key）和隐私密钥（Privacy Key）直接源于网络密钥。



http://www.rfsister.com/article/23645342.html